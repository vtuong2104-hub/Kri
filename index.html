<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SQUIRREL'S PAW</title>
    <style>
        body {
            margin: 0; padding: 0; background-color: #000;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            min-height: 100vh; color: white; font-family: sans-serif;
            user-select: none; -webkit-user-select: none;
        }
        .content-container {
            width: 100%; max-height: 80vh; display: flex; justify-content: center; align-items: center;
        }
        img, video {
            max-width: 95%; max-height: 80vh; object-fit: contain;
            pointer-events: none;
            border-radius: 8px;
        }
        .btn-visit {
            margin-top: 25px; padding: 12px 35px; background: #fff; color: #000;
            text-decoration: none; border-radius: 30px; font-weight: bold;
            box-shadow: 0 4px 15px rgba(255,255,255,0.2);
        }
        #loading { font-size: 16px; opacity: 0.8; }
    </style>
</head>
<body oncontextmenu="return false;">

    <div id="loading">Đang kiểm tra mã QR...</div>

    <div class="content-container" id="display-area"></div>

    <a id="web-link" href="#" class="btn-visit" style="display: none;">MỞ LIÊN KẾT</a>

    <script>
        const urlParams = new URLSearchParams(window.location.search);
        const idScan = urlParams.get('id');
        const apiURL = "https://sheetdb.io/api/v1/xc2po44ewjdt8/search?id=" + idScan;

        if (idScan) {
            fetch(apiURL)
            .then(res => res.json())
            .then(data => {
                if (data.length > 0) {
                    const item = data[0];
                    const displayArea = document.getElementById('display-area');
                    const loading = document.getElementById('loading');
                    const btn = document.getElementById('web-link');

                    loading.style.display = 'none';
                    
                    // Chấp nhận cả tên cột 'web_url' hoặc 'wed_url'
                    btn.href = item.web_url || item.wed_url; 
                    btn.style.display = 'block';

                    const fileUrl = item.image_url.toLowerCase();
                    // Kiểm tra nếu là video (bao gồm cả link dropbox có mp4)
                    const isVideo = fileUrl.includes('.mp4') || fileUrl.includes('.mov') || fileUrl.includes('video');

                    if (isVideo) {
                        displayArea.innerHTML = `
                            <video id="myVideo" playsinline autoplay loop controlsList="nodownload">
                                <source src="${item.image_url}" type="video/mp4">
                            </video>
                        `;
                        const video = document.getElementById('myVideo');
                        video.play().catch(() => {
                            video.muted = true; // Nếu trình duyệt chặn âm thanh, phát ở chế độ im lặng
                            video.play();
                        });
                    } else {
                        // Hiển thị ảnh
                        displayArea.innerHTML = `<img src="${item.image_url}" alt="Content">`;
                    }
                } else {
                    document.getElementById('loading').innerText = "Mã ID " + idScan + " không tồn tại!";
                }
            })
            .catch(err => {
                document.getElementById('loading').innerText = "Lỗi kết nối máy chủ!";
            });
        } else {
            document.getElementById('loading').innerText = "Vui lòng quét mã QR hợp lệ.";
        }
    </script>
</body>
</html>
