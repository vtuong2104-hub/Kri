<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>Text → Binary / Decimal + QR</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
* { box-sizing: border-box; }

body {
    margin: 0;
    font-family: monospace;
    background: linear-gradient(135deg, #4facfe, #11ff00);
    min-height: 100vh;
    padding: 40px 15px;
}

.app {
    max-width: 920px;
    margin: auto;
    background: #fff;
    border-radius: 10px;
    padding: 22px;
    box-shadow: 0 25px 50px rgba(0,0,0,.25);
}

h2 {
    text-align: center;
    margin-bottom: 18px;
}

textarea, select {
    width: 100%;
    display: block;
    margin: 0 auto;
    padding: 12px;
    border-radius: 10px;
    border: 1px solid #dcdde1;
    font-size: 14px;
}

textarea {
    height: 100px;
    resize: none;
}

select {
    margin-top: 10px;
}

.main {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 20px;
    margin-top: 20px;
}

/* KHUNG GIỐNG NHAU */
.box {
    border: 2px dashed #b2bec3;
    border-radius: 16px;
    padding: 16px;
}

/* QR */
.qr-box {
    text-align: center;
}

.qr-box img {
    width: 160px;
    height: 160px;
    display: block;
    margin: auto;
}

.qr-box button {
    margin-top: 12px;
    width: 100%;
    padding: 10px;
    border-radius: 10px;
    border: none;
    background: #6c5ce7;
    color: #fff;
    cursor: pointer;
}

/* OUTPUT */
.output-box {
    display: flex;
    flex-direction: column;
}

pre {
    flex: 1;
    margin: 0;
    background: #f5f6fa;
    border-radius: 10px;
    padding: 12px;
    overflow-y: auto;
    font-size: 14px;
    white-space: pre-wrap;
    word-break: break-all;
}

.output-box button {
    margin-top: 15px;
    padding: 10px;
    border-radius: 10px;
    border: none;
    background: #00b894;
    color: #fff;
    cursor: pointer;
}

/* MOBILE */
@media (max-width: 700px) {
    .main {
        grid-template-columns: 1fr;
    }
}
</style>
</head>

<body>

<div class="app">
<h2>squirrel's paw </h2>

<textarea id="input" placeholder="Nhập text hoặc link Dropbox vô đây"></textarea>

<select id="mode">
    <option value="binary">Nhị phân (Binary)</option>
    <option value="decimal">Thập phân (Decimal)</option>
</select>

<div class="main">

    <!-- LEFT -->
    <div class="box qr-box">
        <img id="qrImg" src="">
        <button onclick="downloadQR()">Download QR PNG</button>
    </div>

    <!-- RIGHT -->
    <div class="box output-box">
        <pre id="output"></pre>
        <button onclick="downloadTXT()">Download TXT</button>
    </div>

</div>
</div>

<script>
let result = "";
let qrURL = "";

document.getElementById("input").addEventListener("input", convert);
document.getElementById("mode").addEventListener("change", convert);

function convert() {
    let text = document.getElementById("input").value.trim();

    if (text.startsWith("https://www.dropbox.com/scl/fi/")) {
        text = text.replace("https://www.dropbox.com/scl/fi/", "");
    }

    if (!text) {
        result = "";
        document.getElementById("output").textContent = "";
        document.getElementById("qrImg").src = "";
        return;
    }

    const mode = document.getElementById("mode").value;
    let out = [];

    for (let char of text) {
        const code = char.charCodeAt(0);
        out.push(
            mode === "binary"
                ? code.toString(2).padStart(8, "0")
                : code.toString(10)
        );
    }

    result = out.join(" ");
    document.getElementById("output").textContent = result;

    qrURL =
        "https://api.qrserver.com/v1/create-qr-code/?size=160x160&format=png&data=" +
        encodeURIComponent(result);

    document.getElementById("qrImg").src = qrURL;
}

function downloadQR() {
    if (!qrURL) return;
    const a = document.createElement("a");
    a.href = qrURL;
    a.download = "qr_code.png";
    a.click();
}

function downloadTXT() {
    if (!result) return;
    const blob = new Blob([result], { type: "text/plain" });
    const a = document.createElement("a");
    a.href = URL.createObjectURL(blob);
    a.download = "encoded.txt";
    a.click();
    URL.revokeObjectURL(a.href);
}
</script>

</body>
</html>